import{cw as s,cx as l,cy as x,ay as m,cz as y}from"./index-DMJZMQ0x.js";function p(n,r){return{...r,filterMode:n.mode}}function E(n,r){return I(n,r).next().value??null}function M(n,r,t){const e=T(n);if(e&&(s(r,e[0])||l(t,e[1])))return"";const u=Array.from(I(n,r,t)),c=h(u,r,t)?"1=1":u.map(a=>a.where||"1=1").reduce((a,i)=>x(a,i),"");return c&&c!=="1=1"?c:""}function T(n){if(d(n)==="manual")return null;const r=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:t,maxScale:e}of n.filters)r[0]=Math.max(r[0],f(t)),r[1]=Math.min(r[1],o(e));return r}function*I(n,r,t){if(d(n)==="manual"){const e=n.filters.find(u=>u.id===n.activeFilterId);e&&(yield e)}else{typeof r=="object"&&(r=r.scale);for(const e of n.filters)F(e.minScale,e.maxScale,r,t)&&(yield e)}}function h(n,r,t){var c,a;if(n.length===0)return!0;const e=f((c=n.at(0))==null?void 0:c.minScale),u=o((a=n.at(-1))==null?void 0:a.maxScale);if(l(e,r)||s(u,t))return!0;for(let i=0;i<n.length-1;i++){const N=n[i],S=n[i+1];if(l(f(S.minScale),o(N.maxScale)))return!0}return!1}function F(n,r,t,e){return n=f(n),t=f(t),r=o(r),!(!m(t,n)&&(e??t)>n)&&!y(r,t)&&(e===void 0||!m(e,n))}function d(n){return"mode"in n?n.mode:n.filterMode}function f(n){return n||Number.POSITIVE_INFINITY}function o(n){return n||0}export{M as c,p as i,E as u};
